[
  
    {
      "title": "PMSM电机控制（四）：PID的参数整定",
      "url": "http://localhost:4000/motorcontrol/2025/06/19/PMSM_4.html",
      "date": "2025-06-19T00:00:00+08:00",
      "categories": ["motorcontrol"],
      "tags": ["PMSM","PID"],
      "content": "一、概述在FOC控制中，常使用PID调节器用于电流环、转速环。对于PID调节器的参数整定方法，已经有大量的文献介绍。本文将介绍转速环PI和电流环PI的参数整定原理。二、前馈解耦-电流环PI整定2.1 电机的传递函数首先回顾第二章节中的式（11）：\\[\\begin{align}    \\left[\\begin{matrix}    u_d \\\\    u_q\\end{matrix}\\right] =\\left[\\begin{matrix}    R_s &amp; -\\omega_e L_q \\\\    \\omega_e L_d &amp; Rs\\end{matrix}\\right]\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]+\\left[\\begin{matrix}    L_d &amp; 0 \\\\     0 &amp; L_q\\end{matrix}\\right]\\frac{d}{dt}\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]+\\left[\\begin{matrix}    0\\\\    \\omega_e \\psi_f\\end{matrix}\\right]\\end{align}\\]将该式重写为：\\[\\begin{align}    \\frac{d}{dt}i_d&amp;=-\\frac{R_s}{L_d}i_d+\\frac{L_q}{L_d}\\omega_e i_q+\\frac{1}{L_d}u_d \\\\    \\frac{d}{dt}i_q&amp;=-\\frac{R_s}{L_q}i_q-\\frac{1}{L_q}\\omega_e (L_di_d+\\psi_f)+\\frac{1}{L_q}u_q \\end{align} \\tag{1}\\]从式（1）中可以看出，定子电流$i_d,i_q$分别在q轴和d轴方向产生耦合电压。为消除该耦合电压，我们可以令：\\[\\begin{align}    u_{d0} &amp;= u_d +\\omega_e L_q i_q = R_si_d + L_d\\frac{d}{dt}i_d\\\\    u_{q0} &amp;=u_q-\\omega_e (L_di_d+\\psi_f)=R_si_q+L_q\\frac{d}{dt}i_q\\end{align} \\tag{2}\\]其中：$u_{d0},u_{q0}$分别为解耦后的d轴和q轴电压。其中$\\omega_e L_q i_q$ 和 $-\\omega_e (L_di_d+\\psi_f) $就是前馈项。对式（2）经过拉普拉斯变换后，可以得到：\\[\\begin{matrix}    \\left[\\begin{matrix}        u_{d0}(s)\\\\        u_{q0}(s)    \\end{matrix}\\right] =     \\left[\\begin{matrix}        R_s+sL_d &amp; 0\\\\        0 &amp;R_s+sL_q    \\end{matrix}\\right]    \\left[\\begin{matrix}        i_d(s)\\\\        i_q(s)    \\end{matrix}\\right] \\end{matrix}\\]令\\(U(s)=\\left[\\begin{matrix}        u_{d0}(s)\\\\        u_{q0}(s)    \\end{matrix}\\right],    Y(s)=\\left[\\begin{matrix}        i_d(s)\\\\        i_q(s)    \\end{matrix}\\right],    G_m(s)=\\left[\\begin{matrix}        \\frac{1}{R_s+sL_d} &amp; 0\\\\        0 &amp;\\frac{1}{R_s+sL_q}    \\end{matrix}\\right]\\)上式可以表示为：\\[Y(s)=G_m(s)U(s) \\tag{3}\\]2.2 PI的传递函数让我们回顾下PID的表达公式：\\[u(t)=K_p(e(t)+\\frac{1}{T_I}\\int_0^t e(t))\\]其中：$u(t)$是PID调节器的输出值，$e(t)$表示PID调节器的偏差输入值，$T_I$是积分时间常数。对其拉普拉斯变化后，得到PI的传递函数为：\\[G_{pi}(s)=\\frac{U(s)}{E(s)}=K_p(1+\\frac{1}{T_Is})\\]d、q轴PID的传递函数可以表示为：\\[G_{pi}(s)=\\left[\\begin{matrix}    K_{pd}+K_{id}\\frac{1}{s} &amp; 0\\\\    0 &amp; K_{pq}+K_{iq}\\frac{1}{s}\\end{matrix}\\right] \\tag{4}\\]2.3 滞后环节的传递函数延迟传递函数：在实际计算过程中，CPU进入中断读取电流反馈值，然后进行PI调节器的计算，得到输出电压（或者三角波比较值），但是输出电压或者较值不是立即作用出去的，通常会延迟一个PWM周期，才会将比较值输出出去。这样就造成了采样和计算的延时。逆变器的传递函数：经过延迟环节，更新了三角波的比较值后，输出的电压是立刻作用到了负载上面吗？还不是的。需要经过逆变电路的调制，才能作用到电机上，通常这个环节会取0.5倍PWM周期的延迟。综上，在滞后环节里，共有$1.5T_s$的延迟。其中$T_s$表示开关周期。根据拉普拉斯变换的延时定理，滞后环节的传递函数可以表示为：\\[G_D(s)=e^{-1.5T_ss}\\]为方便后续的计算，我们可以对分母$e^{1.5T_ss}$泰勒展开，得到：\\[e^{1.5T_ss}=1+1.5T_ss+\\frac{(1.5T_s)^2}{2}s^2+o(s^2)\\]实际控制系统中，$T_s$往往是us级别，二次项以及高阶无穷小往往可以忽略，因此，可以表示为：\\[e^{1.5T_ss}\\approx 1+1.5T_ss\\]即，滞后环节的传递函数可以表示为：\\[G_D(s)\\approx \\frac{1}{1+1.5T_ss}\\tag{5}\\]2.4 PI参数整定结合式（3）,（4）,(5)，电流环的传递框图可以表示为:电流环的开环传递函数可以表示为:\\[\\begin{align}    G_i(s)&amp;=G_{pi}(s)*G_D(s)*G_m(s)\\\\    &amp;=(K_p+\\frac{Ki}{s})*\\frac{1}{1+1.5T_ss}*\\frac{1}{R_s+Ls}\\\\    &amp;=\\frac{K_i}{R_s}*\\frac{1}{s(1+1.5T_ss)}*\\frac{1+\\frac{K_p}{K_i}s}{1+\\frac{L}{R_s}s}\\end{align}\\]从提高系统稳定性角度考虑，可以将PI调节器零点抵消电流控制器对象传递函数的极点，我们可以令\\[\\frac{K_p}{K_i}=\\frac{L}{R_s}\\tag{6}\\]来抵消式中的第三项。最终，我们可以得到：\\[G_i(s)=\\frac{K_i}{R_s}*\\frac{1}{s(1+1.5T_ss)}\\]这是一个典型I系统。I系统的缺点是对斜坡和加速度输入的跟踪性能差。由于电流环常为单位阶跃输入，因此由I系统表示仍可以有较高的控制能力。典型I系统的开环传递函数表达式为：\\[W_1(s)=\\frac{K}{s(Ts+1)}\\]其中$K=\\frac{K_i}{R_s},T=1.5T_s$。典型I系统也是个二阶控制系统，传递函数写成标准形式为：\\[W_1(s)=\\frac{\\omega _n^2}{s^2+2\\zeta \\omega _ns+\\omega _n^2}\\]其中：\\[\\begin{align}    &amp;自然频率表示为：\\omega _n=\\sqrt{\\frac{K}{T}}\\\\    &amp;阻尼比表示为：\\zeta = \\frac{1}{2\\sqrt{KT}}\\\\\\end{align}\\]在控制系统中，除了那些不允许有振荡的系统外，通常希望控制系统具有适当的阻尼、较快的响应速度和较快的调节时间。因此，二阶控制系统的设计，一般取$\\zeta=0.4\\sim0.8$。常用的，我们取阻尼比$\\zeta=0.707$，即$KT=0.5$以获得均衡的控制性能。对于PI控制器，则：\\[\\frac{K_i}{R_s}*1.5T_s = 0.5\\tag{7}\\]联合式（6）和式（7），可以得到：\\[\\begin{align}    K_p &amp;= \\frac{L}{3T_s}\\\\    K_i &amp;= \\frac{R_s}{3T_s}\\tag{8}\\end{align}\\]基于前馈解耦的PI整定，需要对电机模型的参数有精确的识别。然而，由于内置式PMSM凸极效应的存在，模型误差给系统造成的影响不可忽略，因此这种方式并不能实现完全的解耦。三、转速环PI整定3.1 电机的传递函数永磁同步电机的电磁转矩方程为：\\[T_e=\\frac{3}{2}p_ni_q[i_d(L_d-L_q)+\\psi_f]\\]采用$i_d=0$控制时，电磁转矩中的$i_d$项可以忽略，$T_e=\\frac{3}{2}p_ni_q\\psi_f$,因此，这部分可以看成纯增益的环节。\\[G_T(s)=\\frac{3}{2}p_n\\psi_f \\tag{9}\\]运动学方程为：\\[J\\frac{d\\omega_m}{dt}=T_e-T_L-B\\omega_m\\]经过拉普拉斯变化后为：\\[J\\omega_m s = T_e-T_L-B\\omega_m\\]转矩和转速的传递函数为：\\[G_M(s)=\\frac{1}{Js+B} \\tag{10}\\]3.2 PI的传递函数PI的传递函数与电流环一致，为：\\[G_{pi}(s)=K_p+\\frac{K_i}{s} \\tag{11}\\]3.3 滞后环节的传递函数在实际应用过程中，转速环计算出的控制指令通常要在下一个控制周期中作用，令转速环的控制周期为$T_d$，转速滞后环节的传递函数可以表示为：\\[G_D(s)=\\frac{1}{T_ds+1} \\tag{12}\\]3.4 电流内环的传递函数电流内环的传递函数\\[G_i(s)=\\frac{K_i}{R_s}*\\frac{1}{s(1+1.5T_ss)}\\]FOC采用的级联结构是一种串联结构，外环的控制指令作为内环的参考输入信号。为了实现在设计外环控制系统（往往对应着最终控制目标）时能够忽略内环控制系统的影响，从而简化外环设计，必然要求内环的动态（带宽）要远高于外环带宽，体现为外环控制指令可以被内环完美跟踪，外环控制性能能够直接代表最终控制性能。因此，在计算转速外环的参数时，可以把电流内环视作一阶惯性环节，它的作用相当于延时。又由于在实际运算过程中，往往电流环的带宽远高于转速环的带宽，因此可以把该环节的延时传递函数忽略，合并至转速环滞后环节的传递函数。3.5 PI参数整定结合式（9）~（12），转速环的控制框图可以表示为为了进一步简化转速环的计算，忽略负载转矩的扰动，忽略阻尼系数$B$，转速环的开环传递函数可以表示为：\\[\\begin{align}    G_s(s)&amp;=G_{pi}(s)*G_D(s)*G_T(s)*G_M(s)\\\\    &amp;=\\frac{K_ps+K_i}{s}*\\frac{1}{T_ds+1}*\\frac{3}{2}p_n\\psi_f*\\frac{1}{Js}\\\\    &amp;=\\frac{3p_n\\psi_f K_i}{2J}*\\frac{\\frac{K_p}{K_i}s+1}{s^2(T_ds+1)}\\end{align}\\]这是一个典型II系统，它的通用开环传递函数表示形式为：\\[W_2(s)=\\frac{K(\\tau s+1)}{s^2(Ts+1)}\\]其中$K=\\frac{3p_n\\psi_f K_i}{2J}$，对应的是机械角速度。如果控制目标转速单位为rpm，那么$K_n=\\frac{45p_n\\psi_f K_i}{\\pi J}$。同样的，典型II系统也是一个三阶系统，从传递函数中可以看出：  有两个纯积分环节，幅频特性初始斜率为-40dB，初始相位角度为-180°；  转折频率分为$\\frac{1}{T_d}$和$\\frac{1}{\\tau}$。为了方便分析该控制系统，定义了新变量中频段$h=\\lg\\frac{1}{T_d}-\\lg\\frac{1}{\\tau}$，它的意义是斜率为-20dB/sec的中频宽度。中频带宽和截止频率的相位裕度是我们转速环设计的指标。截止频率处的相位裕度比较好确定，至少为45°，且越大越好。中频带宽一般由采样时间来决定。假设电流环的采样频率为20kHz，电流环的采样周期$T_s=0.00005$，取转速环的采样周期是电流环的10倍，即$T_d=0.0005$。那么惯性环节的转折频率为$\\frac{1}{T_d}=2000Hz$。而$\\lg2000 = 3.3$，设计转速环中频带宽$h=2.0$，可以计算得出，微分环节的转折频率$\\frac{1}{\\tau}=20Hz$，那么$\\tau=0.05$。接下来，我们需要设计相位裕度。我们知道相频曲线的最高点，肯定是相位裕度最大的点。并且，这个点正好是两个转折频率的中点。因此，我们将截止频率设计至两个转折频率的中点。仍以刚才的数据为例，$\\lg\\omega_c=\\lg\\frac{1}{T_d}-\\frac{h}{2}$，可以得到，$\\omega_c=\\frac{1}{T_d*10^{\\frac{h}{2}}}$截止频率和开环增益的关系为$\\omega_c=K_n*\\tau$。我们可以得到关系式：\\[\\begin{align}    &amp;K_n=\\frac{1}{T_d^2 10^{\\frac{3h}{2}}}\\\\    &amp;\\tau = T_d*10^h\\end{align}\\]求解之后，得到：\\[\\begin{align}    K_p &amp;= \\frac{\\pi J}{45p_n\\psi_f T_d 10^{\\frac{h}{2}}}\\\\    K_i &amp;= \\frac{K_p}{T_d10^h}\\end{align}\\]四、结语根据以上的推导过程可以看出，上述电流环和转速环的PI整定中，都用到了大量的近似或者忽略处理，实际应用过程中，仍需要大量的调试来确定pi参数。"
    },
  
    {
      "title": "PMSM电机控制（三）：空间矢量调制",
      "url": "http://localhost:4000/motorcontrol/2025/06/04/PMSM_3.html",
      "date": "2025-06-04T00:00:00+08:00",
      "categories": ["motorcontrol"],
      "tags": ["PMSM","SVPWM"],
      "content": "一、概述SVPWM是由三相功率逆变器的六个功率开关元件组成的特定开关模式产生的脉宽调制波，能够使输出电流波形尽可能接近于理想的正弦波形。如图是一个经典的三相逆变电路。在算法模拟中，逆变器是虚拟的模型。在真实工况中，该逆变器是真实的元器件。通过控制这六个开关的导通和切断，配合左边的直流电压源，该逆变器可以在右侧电机定子相上产生所需要的正弦电压。这六个开关的开关状态是离散的，所以该算法很适合离散的数字系统。二、原理介绍2.1 空间矢量我们可以在三相绕组ABC的施加如下的相电压：\\[\\begin{align}    u_a&amp;=U_mcos(\\omega_e t)\\\\    u_b&amp;=U_mcos(\\omega_e t - \\frac{2}{3}\\pi)\\\\    u_c&amp;=U_mcos(\\omega_e t + \\frac{2}{3}\\pi)\\end{align}\\]他们的合成电压矢量可以表示为：\\[\\begin{align}    U_{out} &amp;= u_a + u_b e^{j\\frac{2}{3}\\pi}+u_c e^{-j\\frac{2}{3}\\pi}\\\\    &amp;= U_mcos(\\omega_e t) + U_mcos(\\omega_e t - \\frac{2}{3}\\pi)e^{j\\frac{2}{3}\\pi} + U_mcos(\\omega_e t + \\frac{2}{3}\\pi)e^{-j\\frac{2}{3}\\pi}\\\\    &amp;= \\frac{3}{2}U_m e^{j\\omega_e t}\\end{align}\\]式中的$e^{j\\frac{2}{3}\\pi}$表示ABC相绕组在空间上的分布差120°。可以看出合成后的空间矢量幅值为$\\frac{3}{2}U_m$，因此为了符合等幅值变换，会在前面乘以个系数$\\frac{2}{3}$。这个系数可以在Clark变换中加入。如下图所示，定义开关量$s_a,s_b,s_c,s_a’,s_b’,s_c’$表示 6 个功率开关器件的开关状态。当$s_a,s_b,s_c$为1时，表示逆变电路的上桥臂导通，下桥臂关断（$s_a’,s_b’,s_c’$为0）；反之，当$s_a,s_b,s_c$为0时，表示逆变电路的上桥臂关断，下桥臂导通。由于同一桥臂上下开关器件不能同时导通，则上述的逆变器三路逆变桥的开关组态一共有8种。对于不同的开关状态组合$s_{abc}$，可以得到 8个基本电压空间矢量，这样逆变器的8种开关模式就对应8个电压空间矢量。SVPWM都假设电机拥有平衡的三相绕组，也就是三相的相电阻相等。当开关状态为：\\[S_a=1, S_b=0, S_c=0\\]这三个开关函数可以用一个向量$(1 0 0)$来表示。此时可以根据串联分压定理得到：\\[\\begin{align}U_{AN} &amp;= 2U_{NB} = 2U_{NC}\\\\U_{dc} &amp;= U_{AN}+U_{NB}\\end{align}\\]由此，我们可以得出三个相电压为：\\[\\begin{align}    U_{AN} &amp;= \\frac{2}{3}U_{dc}\\\\    U_{BN} &amp;=U_{CN} = -\\frac{1}{3}U_{dc}\\end{align}\\]该向量可以表示为：\\[U_{out}=\\frac{2}{3}(\\frac{2}{3}U_{dc}-\\frac{1}{3}U_{dc}e^{j\\frac{2}{3}\\pi}-\\frac{1}{3}U_{dc}e^{-j\\frac{2}{3}\\pi} )= \\frac{2}{3}U_{dc}\\]其余七组向量也可以计算得出，如下表：            $s_a$      $s_b$      $s_c$      $U_{AN}$      $U_{BN}$      $U_{CN}$      Vector      $U_{out}$                  0      0      0      0      0      0      $U_0$      0              1      0      0      $\\frac{2}{3}U_{dc}$      $-\\frac{1}{3}U_{dc}$      $-\\frac{1}{3}U_{dc}$      $U_4$      $\\frac{2}{3}U_{dc}$              1      1      0      $\\frac{1}{3}U_{dc}$      $\\frac{1}{3}U_{dc}$      $-\\frac{2}{3}U_{dc}$      $U_6$      $\\frac{2}{3}U_{dc}e^{j\\frac{1}{3}\\pi}$              0      1      0      $-\\frac{1}{3}U_{dc}$      $\\frac{2}{3}U_{dc}$      $-\\frac{1}{3}U_{dc}$      $U_2$      $\\frac{2}{3}U_{dc}e^{j\\frac{2}{3}\\pi}$              0      1      1      $-\\frac{2}{3}U_{dc}$      $\\frac{1}{3}U_{dc}$      $\\frac{1}{3}U_{dc}$      $U_3$      $-\\frac{2}{3}U_{dc}$              0      0      1      $-\\frac{1}{3}U_{dc}$      $-\\frac{1}{3}U_{dc}$      $\\frac{2}{3}U_{dc}$      $U_1$      $\\frac{2}{3}U_{dc}e^{-j\\frac{2}{3}\\pi}$              1      0      1      $\\frac{1}{3}U_{dc}$      $-\\frac{2}{3}U_{dc}$      $\\frac{1}{3}U_{dc}$      $U_5$      $\\frac{2}{3}U_{dc}e^{-j\\frac{1}{3}\\pi}$              1      1      1      0      0      0      $U_7$      0      在8种组合电压空间矢量中，包括6个非零矢量以及2各零矢量。它们将复平面分成了六个扇区，如下图所示。2.2 合成原理SVPWM算法的理论基础是平均值等效原理，即在一个开关周期$T_s$内通过对基本电压矢量加以组合，使其平均值与给定电压矢量相等。以扇区I为例，如下图所示。根据平衡等效原则，可以得到：\\[\\begin{align}    T_s U_{out}&amp;=T_4U_4+T_6U_6+T_0U_0(或T_7U_7)\\\\    T_s &amp;= T_4+T_6+T_0\\end{align}\\]再进一步，我们有：\\[\\begin{align}    &amp;U_{out}=\\frac{T_4}{T_s}U_4+\\frac{T_6}{T_s}U_6+\\frac{T_0}{T_s}U_0\\\\    &amp;U_{first}=\\frac{T_4}{T_s}U_4\\\\    &amp;U_{second}=\\frac{T_6}{T_s}U_6\\end{align}\\]观察图中，我们不难得出：\\[\\frac{|U_{out}|}{\\sin(\\frac{2}{3}\\pi)}=\\frac{|U_{first}|}{\\sin(\\frac{\\pi}{3}-\\theta)}=\\frac{|U_{second}|}{\\sin(\\theta)}\\]将\\(|U_4|=\\frac{2}{3}U_{dc},|U_6|=\\frac{2}{3}U_{dc},U_{out}=U_m\\)代入计算得出：\\[\\begin{align}    &amp;T_4 = \\sqrt{3}\\frac{U_m}{U_{dc}}T_s\\sin(\\frac{\\pi}{3}-\\theta)\\\\    &amp;T_6 = \\sqrt{3}\\frac{U_m}{U_{dc}}T_s\\sin(\\theta)\\\\    &amp;T_0 = \\frac{1}{2}(T_s-T_4-T_6)\\end{align}\\]三、算法实现3.1 扇区判断SVPWM算法首先需要知道要合成的参考电压向量$U_{out}$落在了哪个扇区。然后算法就可以根据该扇区相邻的两个非零向量和两个零向量来合成该参考电压向量。我们可以将$U_{out}$分解在电机定子的$\\alpha-\\beta$坐标系上（Clark变换）。对应在两个坐标轴上的电压量是$U_\\alpha$和$U_\\beta$。令：\\[\\begin{align}    &amp;U_{ref1} = U_{\\beta}\\\\    &amp;U_{ref2} = -\\frac{1}{2}U_{\\beta}+\\frac{\\sqrt{3}}{2}U_{\\alpha}\\\\    &amp;U_{ref3} = -\\frac{1}{2}U_{\\beta}-\\frac{\\sqrt{3}}{2}U_{\\alpha}\\end{align}\\]如图所示，当$U_{ref1}&gt;0,U_{ref2}&gt;0,U_{ref3}&lt;0$时，处在扇区I。同理，可得如下表：            $U_{ref1}$      $U_{ref2}$      $U_{ref3}$      扇区                  $&gt;0$      $&gt;0$      $&gt;0$      不存在              $&gt;0$      $&gt;0$      $&lt;0$      I              $&gt;0$      $&lt;0$      $&gt;0$      III              $&gt;0$      $&lt;0$      $&lt;0$      II              $&lt;0$      $&gt;0$      $&gt;0$      V              $&lt;0$      $&gt;0$      $&lt;0$      VI              $&lt;0$      $&lt;0$      $&gt;0$      IV              $&lt;0$      $&lt;0$      $&lt;0$      不存在      3.2 矢量作用时间计算仍然假设$U_{out}$落在第一扇区，可求得：\\[\\begin{align}    &amp;U_{\\alpha}=\\frac{T_4}{T_s}|U_4|+\\frac{T_6}{T_s}|U_6|\\cos(\\frac{\\pi}{3})\\\\    &amp;U_{\\beta}=\\frac{T_6}{T_s}|U_6|\\sin(\\frac{\\pi}{3})\\end{align}\\]通过简单计算后可得到：\\[\\begin{align}    &amp;T_4=\\frac{\\sqrt{3}T_s}{2U_{dc}}(\\sqrt{3}U_\\alpha-U_\\beta)\\\\    &amp;T_6=\\frac{\\sqrt{3}T_s}{U_{dc}}(U_\\beta)\\end{align}\\]同理可得其他扇区的作用时间为：            扇区      $T_{first}$      $T_{second}$                  I      $T_4=\\frac{\\sqrt{3}T_s}{U_{dc}}(\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta)$      $T_6=\\frac{\\sqrt{3}T_s}{U_{dc}}(U_\\beta)$              II      $T_2=\\frac{\\sqrt{3}T_s}{U_{dc}}(-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta)$      $T_6=\\frac{\\sqrt{3}T_s}{U_{dc}}(\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta)$              III      $T_2=\\frac{\\sqrt{3}T_s}{U_{dc}}(U_\\beta)$      $T_3=\\frac{\\sqrt{3}T_s}{U_{dc}}(-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta)$              IV      $T_1=\\frac{\\sqrt{3}T_s}{U_{dc}}(-U_\\beta)$      $T_3=\\frac{\\sqrt{3}T_s}{U_{dc}}(-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta)$              V      $T_1=\\frac{\\sqrt{3}T_s}{U_{dc}}(-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta)$      $T_5=\\frac{\\sqrt{3}T_s}{U_{dc}}(\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta)$              VI      $T_4=\\frac{\\sqrt{3}T_s}{U_{dc}}(\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta)$      $T_5=\\frac{\\sqrt{3}T_s}{U_{dc}}(-U_\\beta)$      $T_{first}$代表每个扇区第一个非零矢量的持续时间，$T_{second}$代表每个扇区第二个非零矢量的持续时间。对于电机控制来说，常见的，我们使用上下计数的三角形载波（Up-Down-Count）来确定PWM的切换点。我们首先定义三个变量：\\[\\begin{align}    &amp;T_a = \\frac{T_s-T_{first}-T_{second}}{4}\\\\    &amp;T_b = T_a+\\frac{T_{first}}{2}\\\\    &amp;T_c = T_b+\\frac{T_{second}}{2}\\end{align}\\]由图可知，这三个变量代表了abc三相开关切换的时间点。对于不同的扇区，切换的时间点$T_{cm}$可以表示为：            扇区      I      II      III      IV      V      VI              $T_{cm1}$      $T_a$      $T_b$      $T_c$      $T_c$      $T_b$      $T_a$              $T_{cm2}$      $T_b$      $T_a$      $T_a$      $T_b$      $T_c$      $T_c$              $T_{cm3}$      $T_c$      $T_c$      $T_b$      $T_a$      $T_a$      $T_b$      四、优化计算通过上述的推导，我们可以发现SVPWM的计算过程比较复杂。因此，我们可以通过优化其计算过程，减少对控制芯片算力的需求。通过对下表的计算可以看出（为简化计算，忽略部分相同系数）,扇区I和IV，扇区II和V，扇区III和VI所对应的切换时间计算公式$T_{cm}$是相同的。            扇区      $T_{a}$      $T_{b}$      $T_{c}$              I      $-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{3}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$              II      $-U_\\beta$      $-\\sqrt{3}U_\\alpha$      $U_\\beta$              III      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{3}{2}U_\\beta$      $-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$              IV      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{3}{2}U_\\beta$      $-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$              V      $U_\\beta$      $-\\sqrt{3}U_\\alpha$      $-U_\\beta$              VI      $-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{3}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$                  扇区      $T_{cm1}$      $T_{cm2}$      $T_{cm3}$              I      $-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{3}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$              II      $-\\sqrt{3}U_\\alpha$      $-U_\\beta$      $U_\\beta$              III      $-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{3}{2}U_\\beta$              IV      $-\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{3}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$              V      $-\\sqrt{3}U_\\alpha$      $-U_\\beta$      $U_\\beta$              VI      $-\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha-\\frac{1}{2}U_\\beta$      $\\frac{\\sqrt{3}}{2}U_\\alpha+\\frac{3}{2}U_\\beta$      同样的，我们可以对扇区判断做简化，令三个临时变量：\\[\\begin{align}    &amp;tmp_1 = U_\\beta \\\\    &amp;tmp_2 = \\frac{1}{2}U_\\beta +\\frac{\\sqrt{3}}{2}U_\\alpha\\\\    &amp;tmp_3 = tmp_2-tmp_1 \\end{align}\\]通过下述代码，实现对切换时间的赋值。其中N和扇区的关系是一一对应。N=3;N=(tmp2&gt;0)?(N-1):N;N=(tmp3&gt;0)?(N-1):N;N=(tmp1&lt;0)?(7-N):N;if(N==1||N==4){    Tcm1 = tmp2;    Tcm2 = tmp1 - tmp3;    Tcm3 =-tmp2;}else if(N==2||N==5){    Tcm1 = tmp3 + tmp2;    Tcm2 = tmp1;    Tcm3 =-tmp1;}else{    Tcm1 = tmp3;    Tcm2 =-tmp3;    Tcm3 =-tmp1-tmp2;}注：此种扇区判断的方式得出的$T_{cm}$符号与前述方法相反。"
    },
  
    {
      "title": "PMSM电机控制（二）：数学模型的坐标变换",
      "url": "http://localhost:4000/motorcontrol/2025/06/03/PMSM_2.html",
      "date": "2025-06-03T00:00:00+08:00",
      "categories": ["motorcontrol"],
      "tags": ["PMSM","Clark","Park"],
      "content": "在上一章中，我们介绍了PMSM在自然坐标系下的数学模型。为了简化自然坐标系下三相PMSM的数学模型，采用的坐标变换通常包括静止坐标变换（Clark变换）和同步旋转坐标变换（Park变换）。一、Clark变换由于a-b-c三相静止坐标系的方程相对复杂，变量较多，耦合度较高，所以对其进行解耦和简化。借助一个虚拟的两相静止坐标系，将复杂的abc坐标系经过数学推算等价到该两相坐标系中进行分析和计算。为简化分析过程，通常在建立α-β静止坐标系时将α轴与a-b-c静止坐标系的a相轴重合，如图所示。由图可得：\\[\\begin{align}    f_\\alpha &amp;= f_a - f_b\\cos(\\frac{\\pi}{3}) - f_c\\cos(\\frac{\\pi}{3})=f_a - \\frac{1}{2}f_b - \\frac{1}{2}f_c \\\\    f_\\beta &amp;= f_b\\cos(\\frac{\\pi}{6}) - f_c\\cos(\\frac{\\pi}{6})=\\frac{\\sqrt{3}}{2}f_b - \\frac{\\sqrt{3}}{2}f_c \\end{align}\\]将a-b-c静止坐标系下的各个相的物理量fa，fb，fc分别映射到α-β轴上，得到虚拟物理量fα，fβ，并分别表示时变电压，电流，磁链。从a-b-c三相静止坐标系变换到α-β静止坐标的变换，称为Clark变换，用T3s/2s表示。代入$U_a=U_m\\cos(\\omega t),U_b=U_m\\cos(\\omega t-\\frac{2\\pi}{3}),U_c=U_m\\cos(\\omega t+\\frac{2\\pi}{3})$可得：\\[\\begin{align}    U_\\alpha&amp;=U_m\\cos(\\omega t)-\\frac{1}{2}U_m\\cos(\\omega t-\\frac{2\\pi}{3})-\\frac{1}{2}U_m\\cos(\\omega t+\\frac{2\\pi}{3})\\\\    &amp;=U_m\\cos(\\omega t)-\\frac{1}{2}U_m(-\\frac{1}{2}\\cos(\\omega t)+\\frac{\\sqrt{3}}{2}\\sin(\\omega t))-\\frac{1}{2}U_m(-\\frac{1}{2}\\cos(\\omega t)-\\frac{\\sqrt{3}}{2}\\sin(\\omega t))\\\\    &amp;=\\frac{3}{2}U_m\\cos(\\omega t)\\\\    U_\\beta&amp;=\\frac{\\sqrt{3}}{2}U_m\\cos(\\omega t-\\frac{2\\pi}{3})-\\frac{\\sqrt{3}}{2}U_m\\cos(\\omega t+\\frac{2\\pi}{3})\\\\    &amp;=\\frac{\\sqrt{3}}{2}U_m(-\\frac{1}{2}\\cos(\\omega t)+\\frac{\\sqrt{3}}{2}\\sin(\\omega t))-\\frac{\\sqrt{3}}{2}U_m(-\\frac{1}{2}\\cos(\\omega t)-\\frac{\\sqrt{3}}{2}\\sin(\\omega t))\\\\    &amp;=\\frac{3}{2}U_m\\sin(\\omega t)=\\frac{3}{2}U_m\\cos(\\omega t-\\frac{\\pi}{2})\\end{align}\\]由运算结果可知，$U_\\alpha$超前$U_\\beta$ 90度，两者赋值相等，但为$U_m$的1.5倍。因此，若采用等幅值变换，需要在原来的表达式上，乘以2/3。那么此时的坐标变换表达式可以表示为：\\[\\left[\\begin{matrix}    f_\\alpha \\\\     f_\\beta \\\\    f_0\\end{matrix}\\right] = T_{3s/2s} \\left[\\begin{matrix}    f_a \\\\    f_b \\\\    f_c \\\\\\end{matrix}\\right]\\]其中：\\[T_{3s/2s}=\\frac{2}{3}\\left[\\begin{matrix}    1 &amp; -\\frac{1}{2} &amp; -\\frac{1}{2}\\\\    0 &amp; \\frac{\\sqrt{3}}{2} &amp; -\\frac{\\sqrt{3}}{2}\\\\    \\frac{1}{2} &amp; \\frac{1}{2} &amp; \\frac{1}{2}\\end{matrix}\\right] \\tag{1}\\]从α-β静止坐标到a-b-c静止坐标系，为$T_{3s/2s}$的逆矩阵，即：\\[T_{2s/3s}=T_{3s/2s}^{-1}=\\left[\\begin{matrix}    1 &amp; 0 &amp; 1 \\\\    -\\frac{1}{2} &amp; \\frac{\\sqrt{3}}{2} &amp; 1 \\\\    -\\frac{1}{2} &amp; -\\frac{\\sqrt{3}}{2} &amp; 1\\end{matrix}\\right] \\tag{2}\\]如果采用等功率变换，那么式中的系数$\\frac{2}{3}$需要改成$\\sqrt{\\frac{2}{3}}$。$f_0$为零序分量，对于三相对称系统而言，在计算静止坐标系下的分量时，零序分量可以忽略。二、Park变换将静止坐标系α-β变换到同步旋转坐标系d-q的坐标变换称为Park变换。从A轴开始，以wt($\\theta_e$)的角速度旋转，这样合成的电压矢量会和dq0坐标轴同步旋转，旋转矢量和旋转的dq0坐标系处于一个相对静止的状态。令d轴的初始位置与A轴重合，如图所示。由图可得：\\[\\begin{align}    f_d &amp;= f_\\alpha \\cos(\\theta_e) +f_\\beta \\sin(\\theta_e)\\\\    f_q &amp;= -f_\\alpha \\sin(\\theta_e) + f_\\beta \\cos(\\theta_e)\\end{align}\\]则Park变换矩阵$T_{2s/2r}$可以表示为：\\[T_{2s/2r}=\\left[\\begin{matrix}    \\cos(\\theta_e) &amp; \\sin(\\theta_e) \\\\    -\\sin(\\theta_e) &amp; \\cos(\\theta_e)\\end{matrix}\\right] \\tag{3}\\]从旋转坐标系变换到静止坐标系，为$T_{2s/2r}$的逆矩阵，即：\\[T_{2r/2s}=T_{2s/2r}^{-1}=\\left[\\begin{matrix}    \\cos(\\theta_e) &amp; -\\sin(\\theta_e) \\\\    \\sin(\\theta_e) &amp; \\cos(\\theta_e)\\end{matrix}\\right] \\tag{4}\\]三、α-β坐标系下的数学模型在上一章节中，我们推导出自然坐标系下的电机电压方程为：\\[\\left[ \\begin{matrix}   u_a \\\\   u_b \\\\   u_c   \\end{matrix}  \\right] = \\left[ \\begin{matrix}   R_s &amp; 0 &amp; 0\\\\   0 &amp; R_s &amp; 0\\\\   0 &amp; 0 &amp; R_s  \\end{matrix}  \\right] \\left[ \\begin{matrix}   i_a \\\\   i_b \\\\   i_c  \\end{matrix}  \\right]+\\frac{d}{dt} \\left[    \\begin{matrix}        \\psi_a \\\\        \\psi_b \\\\        \\psi_c    \\end{matrix}  \\right] \\tag{5}\\]磁链方程为：\\[\\left[\\begin{matrix}    \\psi_a \\\\    \\psi_b \\\\    \\psi_c\\end{matrix}\\right]=\\left[\\begin{matrix}    L_{aa} &amp; M_{ab} &amp; M_{ac} \\\\    M_{ba} &amp; L_{bb} &amp; M_{bc} \\\\    M_{ca} &amp; M_{cb} &amp; L_{cc}\\end{matrix}\\right]\\left[\\begin{matrix}    i_{a} \\\\    i_{b} \\\\    i_{c}\\end{matrix}\\right]+\\psi_f\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\cos(\\theta_e-2\\pi/3) \\\\    \\cos(\\theta_e+2\\pi/3)\\end{matrix}\\right] \\tag{6}\\]由于：\\[\\left[ \\begin{matrix}   u_a \\\\   u_b \\\\   u_c   \\end{matrix}  \\right]=T_{2s/3s}  \\left[\\begin{matrix}    u_\\alpha \\\\    u_\\beta  \\end{matrix}\\right],\\left[ \\begin{matrix}   i_a \\\\   i_b \\\\   i_c   \\end{matrix}  \\right]=T_{2s/3s}  \\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]\\]代入式（5）可得\\[T_{2s/3s}\\left[\\begin{matrix}    u_\\alpha \\\\    u_\\beta  \\end{matrix}\\right] =\\left[\\begin{matrix}   R_s &amp; 0 &amp; 0\\\\   0 &amp; R_s &amp; 0\\\\   0 &amp; 0 &amp; R_s  \\end{matrix}\\right]T_{2s/3s}\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\frac{d}{dt}  (L_s T_{2s/3s}\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\psi_f\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\cos(\\theta_e-2\\pi/3) \\\\    \\cos(\\theta_e+2\\pi/3)\\end{matrix}\\right]) \\tag{7}\\]对式（7）两侧同乘以$T_{3s/2s}$后，可得：\\[\\left[\\begin{matrix}    u_\\alpha \\\\    u_\\beta  \\end{matrix}\\right] =T_{3s/2s}\\left[\\begin{matrix}   R_s &amp; 0 &amp; 0\\\\   0 &amp; R_s &amp; 0\\\\   0 &amp; 0 &amp; R_s  \\end{matrix}\\right]T_{2s/3s}\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\frac{d}{dt}  (T_{3s/2s} L_s T_{2s/3s}\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\psi_f T_{3s/2s}\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\cos(\\theta_e-2\\pi/3) \\\\    \\cos(\\theta_e+2\\pi/3)\\end{matrix}\\right]) \\tag{8}\\]对式（8）整理得：\\[T_{3s/2s}\\left[\\begin{matrix}   R_s &amp; 0 &amp; 0\\\\   0 &amp; R_s &amp; 0\\\\   0 &amp; 0 &amp; R_s  \\end{matrix}\\right]T_{2s/3s} = \\left[\\begin{matrix}    R_s &amp; 0 \\\\    0 &amp; R_s\\end{matrix}\\right]\\]\\[\\begin{align}    T_{3s/2s} L_s T_{2s/3s} &amp;= \\frac{2}{3}\\left[\\begin{matrix}    1 &amp; -\\frac{1}{2} &amp; -\\frac{1}{2}\\\\    0 &amp; \\frac{\\sqrt{3}}{2} &amp; -\\frac{\\sqrt{3}}{2}\\\\\\end{matrix}\\right]\\left[\\begin{matrix}    L_{aa} &amp; M_{ab} &amp; M_{ac} \\\\    M_{ba} &amp; L_{bb} &amp; M_{bc} \\\\    M_{ca} &amp; M_{cb} &amp; L_{cc}\\end{matrix}\\right]\\left[\\begin{matrix}    1 &amp; 0  \\\\    -\\frac{1}{2} &amp; \\frac{\\sqrt{3}}{2}  \\\\    -\\frac{1}{2} &amp; -\\frac{\\sqrt{3}}{2} \\end{matrix}\\right]\\\\    &amp;= \\frac{2}{3}    \\left[\\begin{matrix}        L_{aa}+\\frac{1}{4}L_{bb}+\\frac{1}{4}L_{cc}-M_{ba}-M_{ca}+\\frac{1}{2}M_{bc} &amp; \\frac{\\sqrt{3}}{4}(2M_{ab}-2M_{ac}+L_{bb}+L_{cc})\\\\        \\frac{\\sqrt{3}}{4}(2M_{ba}-2M_{ca}-L_{bb}+L_{cc}) &amp; \\frac{3}{4}(L_{bb}-2M_{bc}+L_{cc})    \\end{matrix}\\right]\\\\    &amp;= \\left[\\begin{matrix}        L_{ls}+\\frac{3}{2}L_{a}+\\frac{3}{2}L_{b}\\cos(2\\theta_e) &amp; \\frac{3}{2}L_{b}\\sin(2\\theta_e)\\\\        \\frac{3}{2}L_b\\sin(2\\theta_e) &amp; L_{ls}+\\frac{3}{2}L_{a}-\\frac{3}{2}L_{b}\\cos(2\\theta_e)    \\end{matrix}\\right]\\end{align}\\]\\[T_{3s/2s}\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\cos(\\theta_e-2\\pi/3) \\\\    \\cos(\\theta_e+2\\pi/3)\\end{matrix}\\right] = \\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\sin(\\theta_e)\\end{matrix}\\right]\\]令\\(L_{\\alpha\\beta}=\\left[\\begin{matrix}        L_{ls}+\\frac{3}{2}L_{a}+\\frac{3}{2}L_{b}\\cos(2\\theta_e) &amp; \\frac{3}{2}L_{b}\\sin(2\\theta_e)\\\\        \\frac{3}{2}L_b\\sin(2\\theta_e) &amp; L_{ls}+\\frac{3}{2}L_{a}-\\frac{3}{2}L_{b}\\cos(2\\theta_e)    \\end{matrix}\\right]\\)将上述化简，代入式（8）后得：\\[\\begin{align}   \\left[\\begin{matrix}    u_\\alpha \\\\    u_\\beta  \\end{matrix}\\right] &amp;=\\left[\\begin{matrix}   R_s &amp; 0 \\\\   0 &amp; R_s   \\end{matrix}\\right]\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\frac{d}{dt}  (\\left[\\begin{matrix}    \\psi_\\alpha \\\\    \\psi_\\beta  \\end{matrix}\\right]) \\\\  &amp;=\\left[\\begin{matrix}   R_s &amp; 0 \\\\   0 &amp; R_s   \\end{matrix}\\right]\\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\frac{d}{dt}  (L_{\\alpha\\beta}    \\left[\\begin{matrix}    i_\\alpha \\\\    i_\\beta  \\end{matrix}\\right]+\\psi_f\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\sin(\\theta_e) \\end{matrix}\\right]) \\end{align} \\tag{9}\\]四、dq坐标系下的数学模型由于：\\[\\left[\\begin{matrix}    u_\\alpha\\\\    u_\\beta\\end{matrix}\\right] = T_{2r/2s}\\left[\\begin{matrix}    u_d \\\\    u_q\\end{matrix}\\right],\\left[\\begin{matrix}    i_\\alpha\\\\    i_\\beta\\end{matrix}\\right] = T_{2r/2s}\\left[\\begin{matrix}    i_d \\\\    i_q\\end{matrix}\\right]\\]将上述公式代入式（9）可得\\[\\begin{align}    \\left[\\begin{matrix}    u_d \\\\    u_q\\end{matrix}\\right] &amp;=T_{2s/2r}\\left[\\begin{matrix}   R_s &amp; 0 \\\\   0 &amp; R_s   \\end{matrix}\\right]T_{2r/2s}\\left[\\begin{matrix}    i_d \\\\    i_q\\end{matrix}\\right] +T_{2s/2r}\\frac{d}{dt}  (T_{2r/2s}  \\left[\\begin{matrix}    \\psi_d \\\\    \\psi_q  \\end{matrix}\\right])\\\\  &amp;=  T_{2s/2r}\\left[\\begin{matrix}   R_s &amp; 0 \\\\   0 &amp; R_s   \\end{matrix}\\right]T_{2r/2s}\\left[\\begin{matrix}    i_d \\\\    i_q\\end{matrix}\\right] +\\frac{d}{dt}\\left[\\begin{matrix}    \\psi_d \\\\    \\psi_q  \\end{matrix}\\right]-  T_{2r/2s}  \\left[\\begin{matrix}    \\psi_d \\\\    \\psi_q  \\end{matrix}\\right]  \\frac{d}{dt}(T_{2s/2r})\\end{align} \\tag{10}\\]注：由于Park变换是关于角度的函数，需要进行复合求导，即：\\(A\\frac{dB}{dt}=\\frac{dAB}{dt}-B\\frac{dA}{dt}\\)对式（10）整理可得：\\[\\begin{align}    \\left[\\begin{matrix}    \\psi_d\\\\    \\psi_q\\end{matrix}\\right]&amp;=T_{2s/2r}\\left[\\begin{matrix}    \\psi_\\alpha\\\\    \\psi_\\beta\\end{matrix}\\right]\\\\&amp;=T_{2s/2r}\\left[\\begin{matrix}        L_{ls}+\\frac{3}{2}L_{a}+\\frac{3}{2}L_{b}\\cos(2\\theta_e) &amp; \\frac{3}{2}L_{b}\\sin(2\\theta_e)\\\\        \\frac{3}{2}L_b\\sin(2\\theta_e) &amp; L_{ls}+\\frac{3}{2}L_{a}-\\frac{3}{2}L_{b}\\cos(2\\theta_e)    \\end{matrix}\\right]    T_{2r/2s}    \\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right] +\\psi_fT_{2s/2r}\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\sin(\\theta_e) \\end{matrix}\\right]\\end{align}\\]\\[T_{2s/2r}\\left[\\begin{matrix}        L_{ls}+\\frac{3}{2}L_{a}+\\frac{3}{2}L_{b}\\cos(2\\theta_e) &amp; \\frac{3}{2}L_{b}\\sin(2\\theta_e)\\\\        \\frac{3}{2}L_b\\sin(2\\theta_e) &amp; L_{ls}+\\frac{3}{2}L_{a}-\\frac{3}{2}L_{b}\\cos(2\\theta_e)    \\end{matrix}\\right]    T_{2r/2s} =\\left[\\begin{matrix}    L_{ls}+\\frac{3}{2}L_a+\\frac{3}{2}L_b &amp; 0 \\\\    0 &amp; L_{ls}+\\frac{3}{2}L_a-\\frac{3}{2}L_b\\end{matrix}\\right]\\]\\[T_{2s/2r}\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\sin(\\theta_e) \\end{matrix}\\right] =\\left[\\begin{matrix}    1 \\\\    0\\end{matrix}\\right]\\]\\[T_{2r/2s}\\frac{d}{dt}(T_{2s/2r})=\\omega_e  \\left[\\begin{matrix}    -\\sin(\\theta_e) &amp; \\cos(\\theta_e)\\\\    -\\cos(\\theta_e) &amp; -\\sin(\\theta_e)  \\end{matrix}\\right]  \\left[\\begin{matrix}    \\cos(\\theta_e) &amp; -\\sin(\\theta_e)\\\\    \\sin(\\theta_e) &amp; \\cos(\\theta_e)  \\end{matrix}\\right] =\\omega_e  \\left[\\begin{matrix}    0 &amp; 1\\\\    -1 &amp; 0  \\end{matrix}\\right]\\]令:\\[\\begin{align}    L_{dq}&amp;=\\left[\\begin{matrix}        L_{ls}+\\frac{3}{2}L_a+\\frac{3}{2}L_b &amp; 0 \\\\        0 &amp; L_{ls}+\\frac{3}{2}L_a-\\frac{3}{2}L_b        \\end{matrix}\\right]\\\\        &amp;=\\left[\\begin{matrix}        L_d &amp; 0 \\\\        0 &amp; L_q        \\end{matrix}\\right]\\end{align}\\]则$\\psi_d,\\psi_q$可以表示为：\\(\\left[\\begin{matrix}    \\psi_d\\\\    \\psi_q\\end{matrix}\\right]=L_{dq}\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right] +\\left[\\begin{matrix}    \\psi_f\\\\    0\\end{matrix}\\right]\\)将上述化简代入式（10）后得到：\\[\\begin{align}    \\left[\\begin{matrix}    u_d \\\\    u_q\\end{matrix}\\right] &amp;=\\left[\\begin{matrix}   R_s &amp; 0 \\\\   0 &amp; R_s \\end{matrix}\\right]\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right] + L_{dq}\\frac{d}{dt}\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]-\\omega_e  \\left[\\begin{matrix}    0 &amp; 1\\\\    -1 &amp; 0  \\end{matrix}\\right](L_{dq}\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]+\\left[\\begin{matrix}    \\psi_f\\\\    0\\end{matrix}\\right])\\\\&amp;=\\left[\\begin{matrix}    R_s &amp; -\\omega_e L_q \\\\    \\omega_e L_d &amp; Rs\\end{matrix}\\right]\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]+\\left[\\begin{matrix}    L_d &amp; 0 \\\\     0 &amp; L_q\\end{matrix}\\right]\\frac{d}{dt}\\left[\\begin{matrix}    i_d\\\\    i_q\\end{matrix}\\right]+\\left[\\begin{matrix}    0\\\\    \\omega_e \\psi_f\\end{matrix}\\right]\\end{align} \\tag{11}\\]可以看出，三相PMSM的数学模型实现了完全的解耦。此时电磁转矩方程可写为：\\[T_e=\\frac{3}{2}p_ni_q[i_d(L_d-L_q)+\\psi_f]\\]"
    },
  
    {
      "title": "PMSM电机控制（一）：永磁同步电机的基本模型",
      "url": "http://localhost:4000/motorcontrol/2025/05/30/PMSM_1.html",
      "date": "2025-05-30T00:00:00+08:00",
      "categories": ["motorcontrol"],
      "tags": ["PMSM"],
      "content": "无论你是在苦苦学习电机的同学，又或是工作上接触了永磁同步电机，想必都听过表贴式、内置式、凸极式、隐极式这些术语。这确实是电机学中容易混淆的概念组合。理解永磁同步电机（PMSM）中这些术语的区别，是掌握其核心特性的关键。一、永磁同步电机的分类      永磁体的安装方式（机械结构）：描述磁铁如何物理地放置在转子上。                  表贴式：永磁体贴在转子铁芯的外表面。                    内置式：永磁体嵌入或埋在转子铁芯内部。                  磁路对称性（电磁特性）：描述电机是否在电磁性能上表现出凸极性（直轴和交轴磁路不对称）。                  凸极式：直轴磁阻与交轴磁阻显著不同。                    隐极式：直轴磁阻与交轴磁阻基本相同（磁路对称）。            二、自然坐标系下的PMSM方程为了简化分析，我们假设三相PMSM为理想电机，且满足下列条件：  永磁磁场和电枢磁场在气隙中均为正弦分布。  忽略电机铁芯的饱和；  不计电机中的涡流和磁滞损耗；  电机中的电流为对称的三相电流。2.1 电压方程\\[\\left[ \\begin{matrix}   u_a \\\\   u_b \\\\   u_c   \\end{matrix}  \\right] = \\left[ \\begin{matrix}   R_s &amp; 0 &amp; 0\\\\   0 &amp; R_s &amp; 0\\\\   0 &amp; 0 &amp; R_s  \\end{matrix}  \\right] \\left[ \\begin{matrix}   i_a \\\\   i_b \\\\   i_c  \\end{matrix}  \\right]+\\frac{d}{dt} \\left[    \\begin{matrix}        \\psi_a \\\\        \\psi_b \\\\        \\psi_c    \\end{matrix}  \\right] \\tag{1}\\]其中:$\\psi_a,\\psi_b,\\psi_c$为三相绕组的磁链,$u_a,u_b,u_c$为定子的三相电压，$R_s$为定子绕组的电阻，$i_a,i_b,i_c$为三相电流。2.2 磁链方程\\[\\left[\\begin{matrix}    \\psi_a \\\\    \\psi_b \\\\    \\psi_c\\end{matrix}\\right]=\\left[\\begin{matrix}    L_{aa} &amp; M_{ab} &amp; M_{ac} \\\\    M_{ba} &amp; L_{bb} &amp; M_{bc} \\\\    M_{ca} &amp; M_{cb} &amp; L_{cc}\\end{matrix}\\right]\\left[\\begin{matrix}    i_{a} \\\\    i_{b} \\\\    i_{c}\\end{matrix}\\right]+\\psi_f\\left[\\begin{matrix}    \\cos(\\theta_e) \\\\    \\cos(\\theta_e-2\\pi/3) \\\\    \\cos(\\theta_e+2\\pi/3)\\end{matrix}\\right] \\tag{2}\\]其中:$L_{aa},L_{bb},L_{cc}$为各绕组的自感，$M_{ab},M_{ac},M_{ba},M_{bc},M_{ca},M_{cb}$为各绕组间的互感，$\\theta_e$为转子的电角度。绕组自感为：\\[\\begin{align}    L_{aa}&amp;=L_{ls}+L_a-L_b\\cos(2\\theta_e)\\\\    L_{bb}&amp;=L_{ls}+L_a-L_bcos(2(\\theta_e-\\frac{2\\pi}{3}))\\\\    L_{cc}&amp;=L_{ls}+L_a-L_bcos(2(\\theta_e+\\frac{2\\pi}{3}))\\end{align}\\]绕组互感为：\\[\\begin{align}    M_{ab}&amp;=-\\frac{L_a}{2}+L_b\\cos(2\\theta_e-\\frac{2\\pi}{3})\\\\    M_{ac}&amp;=-\\frac{L_a}{2}+L_b\\cos(2\\theta_e+\\frac{2\\pi}{3})\\\\    M_{bc}&amp;=-\\frac{L_a}{2}+L_b\\cos(2\\theta_e)\\end{align}\\]其中：$L_{ls}$表示漏感；$L_{a}$表示静止坐标系下，每相自感的平均值（直流量）；$L_{b}$表示静止坐标系下，每相自感波动分量的最大值。2.3 电磁转矩方程电磁转矩$T_e$等于磁场储能对机械角度$\\theta_m$位移的偏导，因此有\\[T_e=\\frac{1}{2}p_n\\frac{\\partial(i_{3s}^T\\cdot\\psi_{3s})}{\\partial\\theta_m} \\tag{3}\\]其中：$p_n$为电机的极对数2.4 机械运动方程\\[J\\frac{d\\omega_m}{dt}=T_e-T_L-B\\omega_m \\tag{4}\\]其中：$\\omega_m$为机械角速度，$T_L$为负载转矩，$J$为转动惯量，$B$为阻尼系数。公式（1）-（4）构成了三相永磁同步电机在自然坐标系下的基本数学模型，可以看出三相PMSM的数学模型是一个非线性、强耦合的多变量系统。为了便于控制器的设计，必须对其进行降阶和解耦。"
    }
  
]